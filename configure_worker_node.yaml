---
- hosts: workers
  become: true
  vars_files:
  - variables
  tasks:
  - name: Remove file (delete file)
    file:
      path: /etc/containerd/config.toml
      state: absent

  - name: Restart Docker service
    service:
      name: containerd
      state: restarted

  - name: Copying token to worker nodes
    copy: src={{ token_file }} dest=join_token

  - name: Joining worker nodes with kubernetes master
    shell: "`grep -i 'kubeadm join' join_token`"
